File secureProperties = new File("${project.rootDir}/secure.properties")

def keystoreLocal = System.properties['user.home'] + '/Android'
def keystoreCI = '/'
try {
    keystoreCI = System.getenv("HOME") + '/' + System.getenv("CIRCLE_PROJECT_REPONAME")
} catch(Exception e) {}

if (new File(keystoreLocal, 'keystore.jks').exists()) {
    ext.storeFilePath = keystoreLocal
} else if (new File(keystoreCI, 'keystore.jks').exists()) {
    ext.storeFilePath = keystoreCI
}

if (secureProperties.exists()) {

    Properties properties = new Properties()
    properties.load(secureProperties.newDataInputStream())
    ext.keyPassword = properties.getProperty("keyalias.password")
    ext.storePassword = properties.getProperty("keystore.password")
    ext.bintrayUser = properties.getProperty("bintray.user")
    ext.bintrayApiKey = properties.getProperty("bintray.apikey")
    ext.bintrayGpgPassword = properties.getProperty("bintray.gpg.password")
    
} else {

    ext.keyPassword = System.getenv("KEYALIAS_PASSWORD")
    ext.storePassword = System.getenv("KEYSTORE_PASSWORD")
    ext.bintrayUser = System.getenv("BINTRAY_USER")
    ext.bintrayApiKey = System.getenv("BINTRAY_APIKEY")
    ext.bintrayGpgPassword = System.getenv("BINTRAY_GPG_PASSWORD")
    
}
